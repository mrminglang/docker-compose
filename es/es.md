# ElasticSearch

## ES介绍

ES是一个基于Lucene构建的开源、分布式、RESTful接口的全文搜索引擎。
Elasticsearch还是一个分布式文档数据库，其中每个字段均可被索引，而且每个字段的数据均可被搜索，ES能够横向扩展至数以百计的服务器存储以及处理PB级的数据。
可以在极短的时间内存储、搜索和分析大量的数据。通常作为具有复杂搜索场景情况下的核心发动机。


## ES概念

### 集群 Cluster

群集是一个或多个节点（服务器）的集合， 这些节点共同保存整个数据，并在所有节点上提供联合索引和搜索功能。
一个集群由一个唯一集群ID确定，并指定一个集群名（默认为“elasticsearch”）。
该集群名非常重要，因为节点可以通过这个集群名加入群集，一个节点只能是群集的一部分。
确保在不同的环境中不要使用相同的群集名称，否则可能会导致连接错误的群集节点。
例如，你可以使用logging-dev、logging-stage、logging-prod分别为开发、阶段产品、生产集群做记录。

### 节点 Node

节点是单个服务器实例，它是群集的一部分，可以存储数据，并参与群集的索引和搜索功能。
就像一个集群，节点的名称默认为一个随机的通用唯一标识符（UUID），确定在启动时分配给该节点。
如果不希望默认，可以定义任何节点名。这个名字对管理很重要，目的是要确定你的网络服务器对应于你的ElasticSearch群集节点。

### 索引 Index

索引是具有相似特性的文档集合。
例如，可以为客户数据提供索引，为产品目录建立另一个索引，以及为订单数据建立另一个索引。
索引由名称（必须全部为小写）标识，该名称用于在对其中的文档执行索引、搜索、更新和删除操作时引用索引。
在单个群集中，你可以定义尽可能多的索引。

### 类型 Type

在索引中，可以定义一个或多个类型。
类型是索引的逻辑类别/分区，其语义完全取决于你。
一般来说，类型定义为具有公共字段集的文档。
例如，假设你运行一个博客平台，并将所有数据存储在一个索引中。
在这个索引中，你可以为用户数据定义一种类型，为博客数据定义另一种类型，以及为注释数据定义另一类型。

### 文档 Docment

文档是可以被索引的信息的基本单位。
例如，你可以为单个客户提供一个文档，单个产品提供另一个文档，以及单个订单提供另一个文档。
本文件的表示形式为JSON（JavaScript Object Notation）格式，这是一种非常普遍的互联网数据交换格式。
在索引/类型中，你可以存储尽可能多的文档。
请注意，尽管文档物理驻留在索引中，文档实际上必须索引或分配到索引中的类型。

### 分片与副本 Shards & Replicas

索引可以存储大量的数据，这些数据可能超过单个节点的硬件限制。
例如，十亿个文件占用磁盘空间1TB的单指标可能不适合对单个节点的磁盘或可能太慢服务仅从单个节点的搜索请求。
为了解决这一问题，Elasticsearch提供细分你的指标分成多个块称为分片的能力。
当你创建一个索引，你可以简单地定义你想要的分片数量。
每个分片本身是一个全功能的、独立的“指数”，可以托管在集群中的任何节点。

**Shards分片的重要性主要体现在以下两个特征：**
+ 1.副本为分片或节点失败提供了高可用性。为此，需要注意的是，一个副本的分片不会分配在同一个节点作为原始的或主分片，副本是从主分片那里复制过来的。
+ 2.副本允许用户扩展你的搜索量或吞吐量，因为搜索可以在所有副本上并行执行。



## ES文档

- 安装文档
    - [docker-compose 安装ES系列](https://www.jianshu.com/p/13d6242aee7c)
    - [docker-compose安装es](https://blog.csdn.net/u013078871/article/details/119987073)
    - [Docker-compose搭建Es集群配置文件](https://zhuanlan.zhihu.com/p/240638785)
    - [Docker 通过 docker-compose 快速搭建 es 集群](https://testerhome.com/topics/15874)
    - [docker-compose安装es](https://huaweicloud.csdn.net/63311ac2d3efff3090b522b4.html)
    - [docker-compose部署es集群](https://blog.51cto.com/u_10272167/2730554)

- Go操作文档
    - [数据操作（3）go操作ElasticSearch](https://zhuanlan.zhihu.com/p/347419756)
    - [Go操作elasticsearch合集](https://blog.csdn.net/m0_46937429/article/details/128835220)

- es-clinet文档
    - [es-client官方文档](https://www.yuque.com/baozhiyige-tewwf/ygxv4r)
